# systemds pairwise-corr.dml -nvargs input="./data/input" output="./data/output"
#
# Copy-paste from this paper: https://dl.acm.org/doi/pdf/10.14778/2732286.2732292

D = read($input);
m = nrow(D);
n = ncol(D);
R = matrix(0, rows=n, cols=n);
#for( i in 1:(n-1) ) {
#parfor( i in 1:(n-1) ) {
parfor( i in 1:(n-1), mode=REMOTE_SPARK, opt=NONE, resultmerge=LOCAL_MEM, log=ALL ) {
    R[i,1]=42
}
write(R, $output);